<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>hjdmmm博客后台</title>
  <link href="../../css/common-edit.css" rel="stylesheet">
</head>
<body>
<div class="container">
  <h1>编辑分类</h1>
  <div>ID <span id="id"></span></div>
  <div>分类名 <input class="text" id="name" type="text"></div>
  <div>描述 <input class="text" id="description" type="text"></div>
  <div>状态 <select id="status">
    <option value="0">正常</option>
    <option value="1">禁用</option>
  </select></div>
  <div>
    <input class="submit-button" id="submit" onclick="submit();" type="button" value="确定">
    <input class="cancel-button" id="cancel" onclick="cancel();" type="button" value="取消">
  </div>
</div>
</body>
</html>

<script src="../../js/ajax.js"></script>
<script src="../../js/url.js"></script>
<script src="../../js/login.js"></script>
<script src="../../js/input.js"></script>
<script>
  let id;

  const submit = function () {
    const name = document.getElementById("name").value;
    const description = document.getElementById("description").value;
    const status = parseInt(getSelectValue(document.getElementById("status")));
    const param = {
      'id': id,
      'name': name,
      'description': description,
      'status': status,
    }
    ajax.put("admin/category", param, function () {
      window.alert("操作成功");
      window.history.back();
    })
  }

  const cancel = function () {
    window.history.back();
  }

  const show = function (category) {
    document.getElementById("name").value = category.name;
    document.getElementById("description").value = category.description;
    setSelectValue(document.getElementById("status").options, category.status.toString());
  }

  window.onload = function () {
    if (!existToken()) {
      window.location.href = "../user/login.html";
    }

    id = getUrlParam(window.location.search, "id");
    document.getElementById("id").innerText = id;

    ajax.get("admin/category/" + id, null, show);
  }
</script>